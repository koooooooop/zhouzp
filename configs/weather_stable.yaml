# è¶…ç¨³å®šè®­ç»ƒé…ç½® - weatheræ•°æ®é›†
# ä¸“é—¨ç”¨äºè§£å†³æ¢¯åº¦çˆ†ç‚¸é—®é¢˜çš„ä¿å®ˆé…ç½®

data:
  dataset_name: "weather"
  data_path: "synthetic"  # ğŸ”§ ä½¿ç”¨åˆæˆæ•°æ®
  seq_len: 96
  pred_len: 96
  features: "M"  # multivariate
  target: "OT"
  # è®­ç»ƒæ•°æ®é…ç½®
  train_ratio: 0.7
  val_ratio: 0.2
  test_ratio: 0.1
  # æ•°æ®åŠ è½½é…ç½®
  batch_size: 8             # ğŸ”§ è¿›ä¸€æ­¥å‡å°æ‰¹æ¬¡å¤§å°
  num_workers: 2
  pin_memory: true
  # æ•°æ®å¤„ç†é…ç½®
  scaler_type: "standard"
  normalize: true
  inverse: false
  standardize: true
  
model:
  model_name: "M2_MOEP"
  
  # åŸºç¡€æ¨¡å‹å‚æ•° - æä¿å®ˆè®¾ç½®
  input_dim: 21
  output_dim: 21
  hidden_dim: 32            # ğŸ”§ è¿›ä¸€æ­¥å‡å°éšè—å±‚ç»´åº¦
  seq_len: 96
  pred_len: 96
  
  # ä¸“å®¶ç³»ç»Ÿå‚æ•° - æœ€ç®€åŒ–è®¾ç½®
  num_experts: 2            # ğŸ”§ æœ€å°‘ä¸“å®¶æ•°é‡
  top_k: 1                  # ğŸ”§ åªæ¿€æ´»1ä¸ªä¸“å®¶
  embedding_dim: 64         # ğŸ”§ å‡å°åµŒå…¥ç»´åº¦
  
  # ä¸“å®¶ç½‘ç»œå‚æ•° - æœ€ä¿å®ˆè®¾ç½®
  expert_params:
    mamba_d_model: 32       # ğŸ”§ æœ€å°Mambaæ¨¡å‹ç»´åº¦
    mamba_scales: [1, 2]    # ğŸ”§ åªä¿ç•™2ä¸ªå°ºåº¦
    
  # æ¸©åº¦è°ƒåº¦å‚æ•° - ä¿å®ˆè®¾ç½®
  temperature:
    initial: 10.0           # ğŸ”§ æ›´é«˜çš„åˆå§‹æ¸©åº¦
    min: 2.0                # ğŸ”§ æ›´é«˜çš„æœ€å°æ¸©åº¦
    max: 20.0               # ğŸ”§ æ›´é«˜çš„æœ€å¤§æ¸©åº¦
    decay_rate: 0.99        # ğŸ”§ æ›´æ…¢çš„è¡°å‡
    
  # Flowæ¨¡å‹å‚æ•° - æœ€ç®€åŒ–è®¾ç½®
  flow:
    num_layers: 2           # ğŸ”§ æœ€å°‘Flowå±‚æ•°
    hidden_dim: 16          # ğŸ”§ æœ€å°éšè—å±‚ç»´åº¦
    latent_dim: 128         # ğŸ”§ å‡å°æ½œåœ¨ç©ºé—´ç»´åº¦
    input_dim: 2016         # 21 * 96
    use_pretrained: true
    
training:
  # åŸºç¡€è®­ç»ƒå‚æ•° - æä¿å®ˆè®¾ç½®
  batch_size: 8             # ğŸ”§ å°æ‰¹æ¬¡å¤§å°
  learning_rate: 0.00005    # ğŸ”§ æ›´å°çš„å­¦ä¹ ç‡
  epochs: 20                # ğŸ”§ å‡å°‘è®­ç»ƒè½®æ•°
  
  # ä¼˜åŒ–å™¨å‚æ•° - ä¿å®ˆè®¾ç½®
  optimizer: "adamw"
  weight_decay: 0.01        # å¢åŠ æƒé‡è¡°å‡
  beta1: 0.9
  beta2: 0.999
  eps: 1e-8
  
  # å­¦ä¹ ç‡è°ƒåº¦ - ä¿å®ˆè®¾ç½®
  scheduler: "cosine"
  lr_min: 1e-7              # ğŸ”§ æ›´å°çš„æœ€å°å­¦ä¹ ç‡
  warmup_epochs: 1          # ğŸ”§ å‡å°‘é¢„çƒ­
  
  # æ¢¯åº¦æ§åˆ¶ - éå¸¸ä¸¥æ ¼
  gradient_clip: 0.1        # ğŸ”§ éå¸¸å°çš„æ¢¯åº¦è£å‰ªé˜ˆå€¼
  use_amp: false            # ç¦ç”¨æ··åˆç²¾åº¦è®­ç»ƒ
  
  # æŸå¤±å‡½æ•°æƒé‡ - æä¿å®ˆè®¾ç½®
  loss_weights:
    prediction: 1.0         # é¢„æµ‹æŸå¤±
    reconstruction: 0.01    # ğŸ”§ æå°çš„é‡æ„æŸå¤±æƒé‡
    triplet: 0.01           # ğŸ”§ æå°çš„ä¸‰å…ƒç»„æŸå¤±æƒé‡
  
  # è®­ç»ƒç­–ç•¥ - æŒ‰æ–‡æ¡£è®¾è®¡
  use_reconstruction_loss: true
  use_triplet_loss: true
  
  # ä¸‰å…ƒç»„æŸå¤±å‚æ•° - ä¿å®ˆè®¾ç½®
  triplet_margin: 0.1       # ğŸ”§ æ›´å°çš„margin
  triplet_mining: "batch_hard"
  
  # éªŒè¯å’Œä¿å­˜è®¾ç½®
  val_check_interval: 1
  save_top_k: 1             # ğŸ”§ åªä¿å­˜æœ€å¥½çš„1ä¸ªæ¨¡å‹
  
  # æ—©åœè®¾ç½® - ä¿å®ˆè®¾ç½®
  early_stopping:
    patience: 3             # ğŸ”§ æ›´çŸ­çš„ç­‰å¾…æ—¶é—´
    min_delta: 0.0001       # ğŸ”§ æ›´å°çš„æœ€å°æ”¹å–„
    
  # æ•°å€¼ç¨³å®šæ€§è®¾ç½® - ä¸¥æ ¼é™åˆ¶
  numerical_stability:
    loss_clamp_max: 5.0     # ğŸ”§ æ›´å°çš„æŸå¤±ä¸Šé™
    grad_norm_threshold: 0.5 # ğŸ”§ æ›´å°çš„æ¢¯åº¦èŒƒæ•°é˜ˆå€¼
    nan_detection: true
    
# è¾“å‡ºè®¾ç½®
output:
  save_dir: "checkpoints"
  log_dir: "logs"
  result_dir: "results"
  
# è®¾å¤‡è®¾ç½®
device: "cuda"
seed: 42

# è°ƒè¯•è®¾ç½®
debug:
  log_gradients: true
  check_numerical: true
  profile_memory: false
  
# å®éªŒè®¾ç½®
experiment:
  name: "weather_ultra_stable"
  description: "Weatheræ•°æ®é›†è¶…ç¨³å®šè®­ç»ƒå®éªŒ"
  tags: ["weather", "ultra_stable", "gradient_fix"] 